<!doctype html>
<html lang="en">
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="description" content="Blue0x Cross-Chain Bridge">
      <link rel="shortcut icon" href="./img/favicon.ico">
      <title>Blue0x | Cross-Chain Bridge</title>
      <link rel="preconnect" href="https://fonts.googleapis.com">
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500;600&display=swap" rel="stylesheet">
      <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">
      <link rel="stylesheet" href="style.css">
   </head>

   <body>
      <div class="back">
      <nav class="navbar">
         <div class="container">
            <a href="index.html" class="navbar-brand">
            <img src="./img/blue0x.png" class="logo">
            </a>
            <p class="circle">‚óè <span id="status">connecting...</span></p>
         </div>
      </nav>


      <div class="div-center-import" id="div-center-import">
      <div class="content">
         <h4>Import to Blue0x</h4>
         <hr />
         <div class="flexContainer">
            <input type="number" class="form-control" id="polyAmountImport" onkeyup="fillAmountImport()" placeholder="0.00" required>
            <button class="coin-label"><img src="./img/matic.png" class="icon">USDX
            </button>
         </div>
         <div>
            <button class="card-arrow" onclick="flipback()"><img src="./img/arrow.png"></button>
         </div>
         <div class="flexContainer">
            <input type="number" class="form-control" id="blxAmountImport" placeholder="0.00" readonly>
            <button class="coin-label"><img src="./img/blue0x.png" class="blx-icon">USDX
            </button>
         </div>
         <div class="flexContainer">
            <input type="text" class="form-control" id="blxAddress" placeholder="Blue0x Wallet Address" onblur="blxAddress()" required>
         </div>
         <div class="fee">Estimated Fee:</div>
         <button type="submit" class="submit-btn" onclick="validateImport()">Connect Wallet</button>
         <span id="errorMessageImport"></span>


         <!-- Import Modal -->
         <div class="modal fade" id="importModal" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-dialog-centered" role="document">
               <div class="modal-content">
                  <div class="modal-header">
                     <h5 class="modal-title">Confirm Transaction</h5>
                  </div>
                  <div class="modal-body">
                     <div class="flexContainer">
                        <input type="number" class="form-control" id="blxAmountImportModal" placeholder="0.00" readonly>
                        <button class="coin-label"><img src="./img/blue0x.png" class="blx-icon">USDX
                        </button>
                     </div>
                     <div>
                        <button class="card-arrow-modal-import"><img src="./img/arrow.png"></button>
                     </div>
                     <div class="flexContainer">
                        <input type="number" class="form-control" id="polyAmountImportModal" placeholder="0.00" readonly>
                        <button class="coin-label"><img src="./img/matic.png" class="icon">USDX
                        </button>
                     </div>
                     <div class="flexContainer">
                        <input type="text" class="form-control" id="blxAddressModal" placeholder="BLX Wallet Address" readonly>
                     </div>
                     <div class="feeModal">Estimated Fee:</div>
                  </div>
                  <div class="modal-footer">
                     <button type="button" class="close-btn-modal" data-dismiss="modal">Cancel</button>
                     <button type="button" class="submit-btn-modal" onclick="importToBLX()">Submit</button>
                  </div>
               </div>
            </div>
         </div>
      </div>


      <div class="div-center-export" id="div-center-export">
         <div class="content">
            <h4>Export to Polygon</h4>
            <hr />
            <div class="flexContainer">
               <input type="number" class="form-control" id="blxAmountExport" onkeyup="fillAmountExport()" placeholder="0.00" required>
               <button class="coin-label"><img src="./img/blue0x.png" class="blx-icon">USDX
               </button>
            </div>
            <div>
               <button class="card-arrow" onclick="flip()"><img src="./img/arrow.png"></button>
            </div>
            <div class="flexContainer">
               <input type="number" class="form-control" id="polyAmountExport" placeholder="0.00" readonly>
               <button class="coin-label"><img src="./img/matic.png" class="icon">USDX
               </button>
            </div>
            <div class="flexContainer">
               <input type="text" class="form-control" id="polyAddress" onblur="polyAddress()" placeholder="Polygon Wallet Address" required>
            </div>
            <div class="fee">Transaction Fee: 0.01 BLX</div>
            <button type="submit" class="submit-btn" data-toggle="modal" onclick="validateExport()">Preview</button>
            <span id="errorMessageExport"></span>


            <!-- Export Modal -->
            <div class="modal fade" id="exportModal" tabindex="-1" role="dialog">
               <div class="modal-dialog modal-dialog-centered" role="document">
                  <div class="modal-content">
                     <div class="modal-header">
                        <h5 class="modal-title">Confirm Transaction</h5>
                     </div>
                     <div class="modal-body">
                        <div class="flexContainer">
                           <input type="number" class="form-control" id="blxAmountExportModal" placeholder="0.00" readonly>
                           <button class="coin-label"><img src="./img/blue0x.png" class="blx-icon">USDX
                           </button>
                        </div>
                        <div>
                           <button class="card-arrow-modal-export"><img src="./img/arrow.png"></button>
                        </div>
                        <div class="flexContainer">
                           <input type="number" class="form-control" id="polyAmountExportModal" placeholder="0.00" readonly>
                           <button class="coin-label"><img src="./img/matic.png" class="icon">USDX
                           </button>
                        </div>
                        <div class="flexContainer">
                           <input type="text" class="form-control" id="polyAddressModal" placeholder="Polygon Wallet Address" readonly>
                        </div>
                        <div class="flexContainer">
                           <input type="password" class="form-control" id="secretPassModal" placeholder="BLX Account Passphrase">
                        </div>
                        <div class="feeModal">Transaction Fee: 0.01 BLX</div>
                     </div>
                     <div class="modal-footer">
                        <button type="button" class="close-btn-modal" data-dismiss="modal">Cancel</button>
                        <button type="button" class="submit-btn-modal" onclick="exportToPoly()">Submit</button>
                     </div>
                  </div>
               </div>
            </div>
         </div>
         
      </div>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"></script>
      
      <script src="./constants.js"></script>
      <script src="./script.js"></script>
      <script>
         function exportToPoly() {
             var amount = $('#polyAmountExportModal').val() * 100;
             var message = $('#polyAddressModal').val();
             $.post(Constants.apiUrl, {
               requestType: "transferCurrency",
               secretPhrase: $('#secretPassModal').val(),
               recipient: Constants.lockWallet,
               currency: Constants.IQDXId,
               units: escapeHtml(amount),
               message: escapeHtml(message),
               messageIsText: "true",
               messageIsPrunable: "true",
               feeNQT: 1000000,
               deadline: 60
             },
           function(result) {
             var transactionNumber = result.transaction;
             $.post(Constants.apiUrl, {
               requestType: "getTransaction",
               transaction: transactionNumber
             },
             function(result2){
                 var parse = JSON.parse(result2)
                 var attachment = parse.attachment
                 var address = attachment.message
             })
             }, "json");
         };
      </script>
   </body>
</html>